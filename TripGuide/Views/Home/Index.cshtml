@using Microsoft.AspNetCore.Identity
@using TripGuide.Enums
@model IndexViewModel
@inject SignInManager<IdentityUser> SignInManager

@{
    ViewData["Title"] = "Trips List";
}

<h1 class="header">Trips List</h1>
<form method="get">
    <label for="locationsToFilter">Locations</label>
    <select id="locationsToFilter" name="locationsToFilter" asp-items="@Model.AllLocations" multiple="multiple"></select>
    <button type="submit">Filter</button>
</form>
<div class="trips-list">
    <span class="title-for-trip-list">Name</span>
    <span class="title-for-trip-list">Location</span>
    <span class="title-for-trip-list">Users love</span>
    <span class="title-for-trip-list">Favorite</span>
   
    @foreach (var trip in Model.Trips)
    {
        <a class="trip-name" asp-action="HomeTripDetails" asp-route-id="@trip.Id"><span>@trip.Name</span></a>
        <span class="trip-location">@trip.Location</span>
        <span class="trip-favorite-count">@trip.FavoriteCount</span>
        @if (SignInManager.IsSignedIn(User))
        {
            @if(!trip.IsCreatedByCurrentUser && !trip.IsAlreadyCurrentUserFavorite)
            {
                <form method="post" asp-controller="Favorite" asp-action="CreateFavorite" asp-route-tripId="@trip.Id" asp-route-source="@SourceEnum.TripList.ToString()">
                    <button type="submit">Add</button>
                </form>
            }
            else
            {
                <form asp-controller="Favorite" asp-action="DeleteFavorite" asp-route-tripId="@trip.Id" asp-route-source="@SourceEnum.TripList.ToString()">
                    <button type="submit">Delete</button>
                </form>
            }
        }
    }

</div> 

